# 공연 예매 프로젝트

## 프로젝트 목적
긴 기간 동안 지속된 코로나 19 팬데믹으로 인해 다양한 예술 공연이 중단되는 상황이 이어졌습니다. 하지만 최근에는 백신 접종과 각종 방역 노력으로 팬데믹이 잦아들면서 문화 예술 분야도 점차 회복의 길을 걷고 있습니다.

이러한 상황 변화에 따라 예술가들과 관람객들은 다시 공연 예정일과 관련 정보를 찾아보고 싶어합니다. 이에 우리는 다양한 공연 예정 및 관련 소식을 한 곳에서 모아 볼 수 있는 플랫폼을 기획하였습니다. 이 플랫폼은 관람객들은 간편하게 원하는 공연을 검색하고 예매할 수 있는 장점이 있습니다.

앞으로 예술 공연의 활기가 계속해서 회복될 것으로 전망되며, 우리의 플랫폼이 이러한 예술 분야의 성장과 발전에 기여할 수 있는 미래를 기대합니다.

<br/>

## 사용 기술스택

- SpringBoot
- Java
- MySQL
- JPA
- SpringSecurity

<br/>

## 프로젝트 기능

### 관리자 및 회원 - 김은정, 강민지

- **회원 관리**
    - 관리자는 회원을 관리할 수 있다.
        - 이메일로 모든 회원을 검색 및 조회할 수 있다.
        - 정책에 위배되는 행위를 하는 회원을 강제로 탈퇴 시킬 수 있다.
            - 탈퇴한 회원의 정보는 soft delete 방식으로 관리한다.
- **회원 가입**
    - 회원과 관리자는 회원 가입을 할 수 있다.
        - 회원 가입 시 이메일과 비밀번호, 휴대폰 번호, 닉네임 정보가 필요하다.
        - 회원 가입 시 이미 가입된 이메일로 회원 가입을 시도하면 에러가 발생한다.
        - 비밀번호는 최소 8자 이상, 16자 이하이며 알파벳 대소문자(a-z, A-Z)와 숫자로 구성되어야 한다. 조건을 만족하지 않으면 에러가 발생한다.
        - 가입한 이메일을 인증하여 계정을 활성화해야 한다.
- **로그인과 로그아웃**
    - 회원과 관리자는 회원 가입의 정보를 이용하여 로그인을 할 수 있다
        - 로그인 시 회원 가입한 적 없는 이메일을 이용하여 로그인을 시도하면 에러가 발생한다
        - 로그인 시 비밀번호가 일치하지 않는다면 에러가 발생한다.
        - 회원은 OAuth2.0을 활용한 소셜(카카오) 로그인을 할 수 있다.
    - 회원과 관리자는 로그아웃을 할 수 있다.
- **회원 정보**
    - 회원은 회원 가입 시에 작성한 정보를 확인 및 수정할 수 있다.
        - 비밀번호를 입력하여 사용자 인증에 성공한 뒤에 확인 및 수정할 수 있다.
        - 회원은 비밀번호를 수정할 수 있다.
        - 회원은 이메일을 수정할 수 없다.
    - 회원은 조건에 따라 등급으로 나눌 수 있다. (등급과 조건은 추가될 수 있음)
        - 회원 가입 시 모든 회원은 일반 등급으로 정해진다.
        - 등급은 일반과 VIP로 구분하며, 특정 조건을 달성하면 자동으로 승급된다.
- **회원 탈퇴**
    - 회원은 회원 탈퇴를 할 수 있다.

### 공연 관리 (조회, 등록, 수정) - 이동우

- **공연 등록**
    - 관리자만 공연을 등록할 수 있음
    - 공연 등록 시 공연명, 공연장소, 상세설명, 공연일정, 공연이미지, 아티스트, 티켓수량을 등록할 수 있음
    - 공연 등록 시 최초 상태값은 stand_by 상태가 돼야 함
- **공연 상세조회**
    - 공연 상세조회 시 공연명, 공연장소, 상세설명, 공연시작일, 공연 일정, 공연이미지, 아티스트, 티켓수량을 조회 할 수 있음
    - 공연 상태가 CANCEL인 공연은 조회 될 수 없음
- **공연목록 조회**
    - 공연 목록조회는 공연명, 공연장소, 공연시작일, 공연이미지 아티스트를 조회 할 수 있음
    - 공연 목록은 더보기 형태로 제공됨
    - 최신순(공연시작일 기준)으로 정렬되며 공연제목, 아티스트명으로 검색기능을 제공
- **공연 수정**
    - 관리자만 공연 수정을 할 수 있음
    - 공연수정은 공연명, 공연장소, 공연일정, 공연이미지, 상세설명, 아티스트, 공연상태(CANCEL)를 변경 할 수 있음
    - 공연일정 변경시 공연시작일 또한 변경 될 수 있음
- **공연 상태변경**
    - 매일 11시59분에 공연 상태변경이 진행됨
    - 공연시작일 일주일전 공연들은 TICKETING 상태로 변경이 돼야 함
    - 해당 해당일자가 공연시작일과 일치하는 공연들은 PROCEEDING 상태로 변경이 돼야 함
    - 공연들중 공연일정 마지막날에서 하루 경과 된 공연들은 END 상태로 변경이 돼야 함

### 공연 예매 기능, 공연 후기 작성 및 북마크 - 이주호, 이명희

- **공연 예매 기능**
    - 회원가입한 유저만 예매가 가능하다.
        - 예매 가능 티켓이 남아 있을 경우에만 예매가 가능하다.
          - 만약 예매 티켓이 남아있지 않을 경우 예매를 진행하면 에러를 발생한다. (동시성 이슈)
        - 각 공연마다 한 명의 유저는 최대 2매만 예매 가능하다.
          - 만약 3매 이상, 1매 미만의 티켓을 예매한다면 에러를 발생한다.
        - 공연 예매는 공연 날짜 일주일 전부터 가능하다.
          - 이 때, VIP 등급은 7일전 부터 예매 가능하고 일반 등급은 6일전 부터 예매 가능하다.
    - 등급별로 예매 가능날짜가 다르다. (가칭 : 일반 등급 | VIP 등급)
        - VIP 등급의 회원은 일반 등급회원보다 하루 빨리 예매가 가능하다. (공연 날짜 7일전)
          - 이 때, 예매 가능 티켓은 총 티켓의 20 %만 제공된다. ( ex) 총 50표 → 10표만 제공)
          - 예매 방식은 VIP 회원들간의 선착순 방식으로 처리한다.
        - 일반 등급의 회원은 VIP등급 회원보다 하루 늦게 예매가 가능하다. (공연 날짜 6일전)
          - 이 때, 예매 가능한 티켓의 수는 (기존 80 % +  VIP 등급이 예매하고 남은 티켓) 이다.
          - 예매방식은 선착순 방식이며, 만약 일반 등급의 회원이 공연 날짜 6일 전보다 빠른 날짜에 예매를 시도하면 에러를 발생한다.
        - VIP 등급은 이 티켓도 예매 가능하다.
    - 회원은 예매 완료시 “예매 완료 확인” 이메일을 받는다.
        - 알림 수신 동의를 했다는 가정 하에 진행한다.
        - 추가 구현) 문자로도 “예매 완료 확인” 알림을 받는다. (TBD)
    - 회원은 “나의 페이지”에 “내 예매 정보”에서 본인이 예매한 예매 정보를 확인할 수 있다.
- **공연 후기 작성 기능**
    - 회원은 본인이 예매한 공연의 공연 종료 시간이 지나면 후기를 작성할 수 있다.
        - 회원이 공연 종료 시간보다 더 빠르게 후기 작성을 시도한다면 에러를 발생한다.
        - 회원은 예매 한 건당 후기 하나를 작성할 수 있다. (예매 2건을 했다면, 후기 두 개를 남길 수 있다.)
    - 회원이 공연 후기를 작성할 때 포함되는 내용은 다음과 같다.
      - → 제목 | 내용 | 작성일 | 작성자
      - 회원은 제목과 내용을 작성한다. 이 때, 내용에는 글만 작성할 수 있다. 글자 수는 1000자로 제한한다.
      - 작성일과 작성자는 자동 작성된다. 시간은 “년/월/일 시간 24:00”까지 표기된다.
        - 추가 구현) 회원은 자신이 작성한 후기에 관해서 내용을 변경하거나 후기를 삭제할 수 있다.
          - 이때, 작성일은 변경되지 않는다.
        - 추가 구현) 회원이 본인이 작성한 후기 내용을 변경 했을 경우 제목 옆에 (편집됨)이라는 문구가 생성된다.
        - 추가 구현) 후기 내용에 사진을 추가할 수 있다. 이 때 최대 10장까지 가능하다.
- **관심있는 공연 등록 기능**
    - 회원은 관심있는 공연을 북마크 할 수 있다.
        - 회원이 북마크 할 수 있는 공연의 개수 제한은 없다.
    - 회원은 북마크 한 공연을 북마크 취소할 수 있다.
    - 회원은 북마크 된 목록을 볼 수 있다.
    - 공연 기간이 지나도 북마크 목록은 남는다.



### 채팅 - 권용수
| [채팅 서버 레파지토리](https://github.com/DevFrog92/performance-chat-application)

- **사용자 기능**
    - 회원가입한 사용자만 채팅 관련 기능을 사용할 수 있다.
    - 사용자는 로그아웃할 수 있다.
- **실시간 채팅 기능**
    - 채팅을 작성 및 전송할 수 있다.
- **채팅방 기능**
    - 전체 채팅방 조회 기능
        - 메인 페이지에서 모든 채팅방을 볼 수 있다.
          - 만약 사용자가 특정 채팅방에 블랙리스트로 등록되어 있다면, 해당 채팅방은 제외되고 보여진다.
    - 채팅방 참여 기능
        - 회원가입 한 유저는 채팅방에 참여할 수 있다.
            - 프라이빗 채팅방의 경우 식별 코드가 반드시 입력되어야 한다.
        - 채팅방에 참여했다는 알림 메시지가 전송된다.
    - 채팅방 나가기 기능
        - 참여자는 채팅방을 나갈 수 있다.
        - 참여자가 나가면 채팅방에는 유저가 나갔다는 알림 메시지가 전송된다.
    - 채팅방 생성 기능
        - 채팅방 생성시 비밀번호를 통해서 프라이빗 채팅방을 개설할 수 있다.
        - 채팅방에 참여할 수 있는 식별 코드를 생성한다.
        - 회원가입한 유저만 채팅 방을 생성할 수 있다.
    - 채팅방 삭제 기능
        - 채팅방의 관리인은 채팅방을 삭제할 수 있다.
            - 만약 채팅방에 참여인원이 남아있으면 모든 인원을 내보내고, 채팅방은 삭제된다.
    - 방에서 강퇴 기능
        - 채팅방 관리자는 참여자를 강퇴시킬 수 있다.
        - 강퇴 당한 사용자는 블랙리스트에 추가된다.

<br/>

## **주차별 개발 계획**

|주차|기능|담당자|
|---|---|---|
|2 주차| 회원 가입 일반 로그인, 이메일 인증, 비밀번호 인증, 로그아웃, 마이 페이지 조회, 회원 정보 수정, 회원 탈퇴 |김은정, 강민지|
|2 주차|후기 작성, 북마크, 북마크 취소, 북마크 목록 조회|이명희, 이주호|
|2 주차|공연 등록, 공연 수정, 공연 목록 조회|이동우|
|2 주차|채팅방 생성, 채팅방 참여, 실시간 채팅, 회원 인증|권용수|
|3 주차| 회원 목록 조회, 회원 검색, 회원 강퇴, 승급, 강등, 소셜 로그인 |김은정, 강민지|
|3 주차|공연 예매, 예매 완료 알림, 예매 정보 확인|이명희, 이주호|
|3 주차|공연 상태 변경|이동우|
|3 주차|프라이빗 채팅방 생성, 채팅방 관리자 기능(강퇴 및 채팅방 삭제)|권용수|
|4 주차|밀린 기능 구현 + 리팩토링||
|5 주차|리팩토링 + 추가구현||
|6 주차|배포||

<br/>

## ERD

![image](https://github.com/Eunjeong21/performance/assets/82052272/ec59bf74-1c15-46c5-b26e-86fe1f17b76c)


